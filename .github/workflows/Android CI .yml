name: Android CI
on:
     push:
       branches: [ "main", "develop" ]
     pull_request:
       branches: [ "main", "develop" ]
  ​
  jobs:
     build-and-test:
       # The type of runner that the job will run on
       runs-on: ubuntu-latest
  ​
       steps:
         # Step 1: Check out the repository code so the workflow can access it.
         - name: Checkout Repository
           uses: actions/checkout@v4
  ​
         # Step 2: Set up the JDK. This action sets up a Java environment for use in actions.
         # Make sure the Java version matches your project's requirements (e.g., 11, 17).
         - name: Set up JDK 17
           uses: actions/setup-java@v4
           with:
             java-version: '17'
             distribution: 'temurin'
             cache: 'gradle'
  ​
         # Step 3: Grant executable permissions to the Gradle wrapper.
         # This is necessary for the subsequent Gradle commands to run.
         - name: Grant execute permission for gradlew
           run: chmod +x gradlew
  ​
         # Step 4: Run unit tests.
         # This command runs the unit tests for the 'debug' build variant.
         - name: Run Unit Tests
           run: ./gradlew testDebugUnitTest
  ​
         # Step 5: Build the debug APK.
         # This ensures that the app compiles and builds correctly.
         - name: Build with Gradle
           run: ./gradlew assembleDebug
​
   # --- DEPLOYMENT JOB (DISABLED BY DEFAULT) ---
   # This job shows how you could build and sign a release APK for deployment.
   # To use this, you must first set up secrets in your GitHub repository for signing.
   # Secrets needed:
   # 1. SIGNING_KEY: Your base64 encoded signing key.
   # 2. KEYSTORE_PASSWORD: The password for the keystore.
   # 3. KEY_ALIAS: The alias of the key.
   # 4. KEY_PASSWORD: The password for the key alias.
   #
   # You would also need to configure your app's build.gradle.kts to use these secrets.
   #
   # deploy:
   #   needs: build-and-test
   #   runs-on: ubuntu-latest
   #   if: github.ref == 'refs/heads/main' && github.event_name == 'push' # Only run on push to main
   #
   #   steps:
   #     - name: Checkout Repository
   #       uses: actions/checkout@v4
   #
   #     - name: Set up JDK 17
   #       uses: actions/setup-java@v4
   #       with:
   #         java-version: '17'
   #         distribution: 'temurin'
   #         cache: 'gradle'
   #
   #     - name: Grant execute permission for gradlew
   #       run: chmod +x gradlew
   #
   #     - name: Decode and install signing key
   #       run: |
   #         echo "${{ secrets.SIGNING_KEY }}" | base64 --decode > ${{ github.workspace }}/app/release-keystore.jks
   #
   #     - name: Build Release APK
   #       run: ./gradlew assembleRelease
   #       env:
   #         KEYSTORE_PASSWORD: ${{ secrets.KEYSTORE_PASSWORD }}
   #         KEY_ALIAS: ${{ secrets.KEY_ALIAS }}
   #         KEY_PASSWORD: ${{ secrets.KEY_PASSWORD }}
   #
   #     - name: Upload Release APK
   #       uses: actions/upload-artifact@v4
   #       with:
   #         name: release-apk
   #         path: app/build/outputs/apk/release/app-release.apk
​
